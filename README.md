Until the last moment, when I still could not reach my companion, 
I wrote the complete code independently and simulated the operation of the two people as much as possible to meet the requirements
